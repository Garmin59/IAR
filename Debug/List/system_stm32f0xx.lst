###############################################################################
#
# IAR ANSI C/C++ Compiler V8.20.2.14835/W32 for ARM       27/Dec/2017  21:15:19
# Copyright 1999-2017 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  
#        D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\system\system_stm32f0xx.c
#    Command line =  
#        -f C:\Users\75BD~1\AppData\Local\Temp\EWAE9A.tmp
#        ("D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\system\system_stm32f0xx.c" -D STM32F0XX -D STM32F051
#        --preprocess=c "D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\Debug\List" -lC "D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\Debug\List" -o "D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\Debug\Obj" --no_cse --no_unroll --no_inline --no_code_motion
#        --no_tbaa --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M0 -e --fpu=None --dlib_config "C:\Program Files
#        (x86)\IAR Systems\Embedded Workbench
#        8.0\arm\INC\c\DLib_Config_Normal.h" -I "D:\Ilya\Projects\332 WS2811
#        hew year light\IAR\system\" -I "D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\project\" -I "D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\CMSIS\" -I "D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\CMSIS\inc\" -I "D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\" -Ol --use_c++_inline --relaxed_fp --source_encoding locale
#        --text_out locale)
#    Locale       =  Russian_RUS.1251
#    List file    =  
#        D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\Debug\List\system_stm32f0xx.lst
#    Object file  =  
#        D:\Ilya\Projects\332 WS2811 hew year
#        light\IAR\Debug\Obj\system_stm32f0xx.o
#
###############################################################################

D:\Ilya\Projects\332 WS2811 hew year light\IAR\system\system_stm32f0xx.c
      1          /**
      2            ******************************************************************************
      3            * @file    system_stm32f0xx.c
      4            * @author  MCD Application Team
      5            * @version V1.0.0
      6            * @date    23-March-2012
      7            * @brief   CMSIS Cortex-M0 Device Peripheral Access Layer System Source File.
      8            *          This file contains the system clock configuration for STM32F0xx devices,
      9            *          and is customized for use with STM32F0-DISCOVERY Kit. 
     10            *          The STM32F0xx is configured to run at 48 MHz, following the three  
     11            *          configuration below:
     12            *            - PLL_SOURCE_HSI (default): HSI (~8MHz) used to clock the PLL, and
     13            *                                        the PLL is used as system clock source.  
     14            *            - PLL_SOURCE_HSE          : HSE (8MHz) used to clock the PLL, and 
     15            *                                        the PLL is used as system clock source.
     16            *            - PLL_SOURCE_HSE_BYPASS   : HSE bypassed with an external clock 
     17            *                                        (8MHz, coming from ST-Link) used to clock
     18            *                                        the PLL, and the PLL is used as system
     19            *                                        clock source.  
     20            *
     21            *  
     22            * 1.  This file provides two functions and one global variable to be called from 
     23            *     user application:
     24            *      - SystemInit(): Setups the system clock (System clock source, PLL Multiplier
     25            *                      and Divider factors, AHB/APBx prescalers and Flash settings),
     26            *                      depending on the configuration selected (see above).
     27            *                      This function is called at startup just after reset and 
     28            *                      before branch to main program. This call is made inside
     29            *                      the "startup_stm32f0xx.s" file.
     30            *
     31            *      - SystemCoreClock variable: Contains the core clock (HCLK), it can be used
     32            *                                  by the user application to setup the SysTick 
     33            *                                  timer or configure other parameters.
     34            *
     35            *      - SystemCoreClockUpdate(): Updates the variable SystemCoreClock and must
     36            *                                 be called whenever the core clock is changed
     37            *                                 during program execution.
     38            *
     39            * 2. After each device reset the HSI (8 MHz Range) is used as system clock source.
     40            *    Then SystemInit() function is called, in "startup_stm32f0xx.s" file, to
     41            *    configure the system clock before to branch to main program.
     42            *
     43            * 3. If the system clock source selected by user fails to startup, the SystemInit()
     44            *    function will do nothing and HSI still used as system clock source. User can 
     45            *    add some code to deal with this issue inside the SetSysClock() function.
     46            *
     47            * 4. The default value of HSE crystal is set to 8MHz, refer to "HSE_VALUE" define
     48            *    in "stm32f0xx.h" file. When HSE is used as system clock source, directly or
     49            *    through PLL, and you are using different crystal you have to adapt the HSE
     50            *    value to your own configuration.
     51            *
     52            ******************************************************************************
     53            * @attention
     54            *
     55            * <h2><center>&copy; COPYRIGHT 2012 STMicroelectronics</center></h2>
     56            *
     57            * Licensed under MCD-ST Liberty SW License Agreement V2, (the "License");
     58            * You may not use this file except in compliance with the License.
     59            * You may obtain a copy of the License at:
     60            *
     61            *        http://www.st.com/software_license_agreement_liberty_v2
     62            *
     63            * Unless required by applicable law or agreed to in writing, software 
     64            * distributed under the License is distributed on an "AS IS" BASIS, 
     65            * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     66            * See the License for the specific language governing permissions and
     67            * limitations under the License.
     68            *
     69            ******************************************************************************
     70            */
     71          
     72          /** @addtogroup CMSIS
     73            * @{
     74            */
     75          
     76          /** @addtogroup stm32f0xx_system
     77            * @{
     78            */  
     79            
     80          /** @addtogroup STM32F0xx_System_Private_Includes
     81            * @{
     82            */
     83          
     84          #include "stm32f0xx.h"
     85          
     86          /**
     87            * @}
     88            */
     89          
     90          /** @addtogroup STM32F0xx_System_Private_TypesDefinitions
     91            * @{
     92            */
     93          
     94          /**
     95            * @}
     96            */
     97          
     98          /** @addtogroup STM32F0xx_System_Private_Defines
     99            * @{
    100            */
    101          /* Select the PLL clock source */
    102          
    103          //#define PLL_SOURCE_HSI        // HSI (~8MHz) used to clock the PLL, and the PLL is used as system clock source
    104          #define PLL_SOURCE_HSE        // HSE (6MHz) used to clock the PLL, and the PLL is used as system clock source
    105          //#define PLL_SOURCE_HSE_BYPASS // HSE bypassed with an external clock (8MHz, coming from ST-Link) used to clock
    106                                        // the PLL, and the PLL is used as system clock source
    107          
    108          /**
    109            * @}
    110            */
    111          
    112          /** @addtogroup STM32F0xx_System_Private_Macros
    113            * @{
    114            */
    115          
    116          /**
    117            * @}
    118            */
    119          
    120          /** @addtogroup STM32F0xx_System_Private_Variables
    121            * @{
    122            */

   \                                 In section .data, align 4
    123          uint32_t SystemCoreClock    = 48000000;
   \                     SystemCoreClock:
   \   00000000   0x02DC6C00         DC32 48000000

   \                                 In section .data, align 4
    124          __I uint8_t AHBPrescTable[16] = {0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 6, 7, 8, 9};
   \                     AHBPrescTable:
   \   00000000   0x00 0x00          DC8 0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 6, 7, 8, 9
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x01 0x02    
   \              0x03 0x04    
   \              0x06 0x07    
   \              0x08 0x09    
    125          
    126          /**
    127            * @}
    128            */
    129          
    130          /** @addtogroup STM32F0xx_System_Private_FunctionPrototypes
    131            * @{
    132            */
    133          
    134          static void SetSysClock(void);
    135          
    136          /** @addtogroup STM32F0xx_System_Private_Functions
    137            * @{
    138            */
    139          
    140          /**
    141            * @brief  Setup the microcontroller system.
    142            *         Initialize the Embedded Flash Interface, the PLL and update the 
    143            *         SystemCoreClock variable.
    144            * @param  None
    145            * @retval None
    146            */

   \                                 In section .text, align 2, keep-with-next
    147          void SystemInit (void)
    148          {    
   \                     SystemInit: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
    149            /* Set HSION bit */
    150            RCC->CR |= (uint32_t)0x00000001;
   \   00000002   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   00000004   0x6800             LDR      R0,[R0, #+0]
   \   00000006   0x2101             MOVS     R1,#+1
   \   00000008   0x4301             ORRS     R1,R1,R0
   \   0000000A   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   0000000C   0x6001             STR      R1,[R0, #+0]
    151          
    152            /* Reset SW[1:0], HPRE[3:0], PPRE[2:0], ADCPRE and MCOSEL[2:0] bits */
    153            RCC->CFGR &= (uint32_t)0xF8FFB80C;
   \   0000000E   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000010   0x6800             LDR      R0,[R0, #+0]
   \   00000012   0x....             LDR      R1,??DataTable2_2  ;; 0xf8ffb80c
   \   00000014   0x4001             ANDS     R1,R1,R0
   \   00000016   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000018   0x6001             STR      R1,[R0, #+0]
    154            
    155            /* Reset HSEON, CSSON and PLLON bits */
    156            RCC->CR &= (uint32_t)0xFEF6FFFF;
   \   0000001A   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   0000001C   0x6800             LDR      R0,[R0, #+0]
   \   0000001E   0x....             LDR      R1,??DataTable2_3  ;; 0xfef6ffff
   \   00000020   0x4001             ANDS     R1,R1,R0
   \   00000022   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   00000024   0x6001             STR      R1,[R0, #+0]
    157          
    158            /* Reset HSEBYP bit */
    159            RCC->CR &= (uint32_t)0xFFFBFFFF;
   \   00000026   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   00000028   0x6800             LDR      R0,[R0, #+0]
   \   0000002A   0x....             LDR      R1,??DataTable2_4  ;; 0xfffbffff
   \   0000002C   0x4001             ANDS     R1,R1,R0
   \   0000002E   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   00000030   0x6001             STR      R1,[R0, #+0]
    160          
    161            /* Reset PLLSRC, PLLXTPRE and PLLMUL[3:0] bits */
    162            RCC->CFGR &= (uint32_t)0xFFC0FFFF;
   \   00000032   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000034   0x6800             LDR      R0,[R0, #+0]
   \   00000036   0x....             LDR      R1,??DataTable2_5  ;; 0xffc0ffff
   \   00000038   0x4001             ANDS     R1,R1,R0
   \   0000003A   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   0000003C   0x6001             STR      R1,[R0, #+0]
    163          
    164            /* Reset PREDIV1[3:0] bits */
    165            RCC->CFGR2 &= (uint32_t)0xFFFFFFF0;
   \   0000003E   0x....             LDR      R0,??DataTable2_6  ;; 0x4002102c
   \   00000040   0x6800             LDR      R0,[R0, #+0]
   \   00000042   0x210F             MOVS     R1,#+15
   \   00000044   0x4388             BICS     R0,R0,R1
   \   00000046   0x....             LDR      R1,??DataTable2_6  ;; 0x4002102c
   \   00000048   0x6008             STR      R0,[R1, #+0]
    166          
    167            /* Reset USARTSW[1:0], I2CSW, CECSW and ADCSW bits */
    168            RCC->CFGR3 &= (uint32_t)0xFFFFFEAC;
   \   0000004A   0x....             LDR      R0,??DataTable2_7  ;; 0x40021030
   \   0000004C   0x6800             LDR      R0,[R0, #+0]
   \   0000004E   0x....             LDR      R1,??DataTable2_8  ;; 0xfffffeac
   \   00000050   0x4001             ANDS     R1,R1,R0
   \   00000052   0x....             LDR      R0,??DataTable2_7  ;; 0x40021030
   \   00000054   0x6001             STR      R1,[R0, #+0]
    169          
    170            /* Reset HSI14 bit */
    171            RCC->CR2 &= (uint32_t)0xFFFFFFFE;
   \   00000056   0x....             LDR      R0,??DataTable2_9  ;; 0x40021034
   \   00000058   0x6800             LDR      R0,[R0, #+0]
   \   0000005A   0x2101             MOVS     R1,#+1
   \   0000005C   0x4388             BICS     R0,R0,R1
   \   0000005E   0x....             LDR      R1,??DataTable2_9  ;; 0x40021034
   \   00000060   0x6008             STR      R0,[R1, #+0]
    172          
    173            /* Disable all interrupts */
    174            RCC->CIR = 0x00000000;
   \   00000062   0x2000             MOVS     R0,#+0
   \   00000064   0x....             LDR      R1,??DataTable2_10  ;; 0x40021008
   \   00000066   0x6008             STR      R0,[R1, #+0]
    175          
    176            /* Configure the System clock frequency, AHB/APBx prescalers and Flash settings */
    177            SetSysClock();
   \   00000068   0x.... 0x....      BL       SetSysClock
    178          }
   \   0000006C   0xBD01             POP      {R0,PC}          ;; return
    179          
    180          /**
    181            * @brief  Update SystemCoreClock according to Clock Register Values
    182            *         The SystemCoreClock variable contains the core clock (HCLK), it can
    183            *         be used by the user application to setup the SysTick timer or configure
    184            *         other parameters.
    185            *
    186            * @note   Each time the core clock (HCLK) changes, this function must be called
    187            *         to update SystemCoreClock variable value. Otherwise, any configuration
    188            *         based on this variable will be incorrect.         
    189            *
    190            * @note   - The system frequency computed by this function is not the real 
    191            *           frequency in the chip. It is calculated based on the predefined 
    192            *           constant and the selected clock source:
    193            *
    194            *           - If SYSCLK source is HSI, SystemCoreClock will contain the HSI_VALUE(*)
    195            *                                              
    196            *           - If SYSCLK source is HSE, SystemCoreClock will contain the HSE_VALUE(**)
    197            *                          
    198            *           - If SYSCLK source is PLL, SystemCoreClock will contain the HSE_VALUE(**)
    199            *             or HSI_VALUE(*) multiplied/divided by the PLL factors.
    200            *
    201            *         (*) HSI_VALUE is a constant defined in stm32f0xx.h file (default value
    202            *             8 MHz) but the real value may vary depending on the variations
    203            *             in voltage and temperature.
    204            *
    205            *         (**) HSE_VALUE is a constant defined in stm32f0xx.h file (default value
    206            *              8 MHz), user has to ensure that HSE_VALUE is same as the real
    207            *              frequency of the crystal used. Otherwise, this function may
    208            *              have wrong result.
    209            *
    210            *         - The result of this function could be not correct when using fractional
    211            *           value for HSE crystal.
    212            * @param  None
    213            * @retval None
    214            */

   \                                 In section .text, align 2, keep-with-next
    215          void SystemCoreClockUpdate (void)
    216          {
   \                     SystemCoreClockUpdate: (+1)
   \   00000000   0xB510             PUSH     {R4,LR}
    217            uint32_t tmp = 0, pllmull = 0, pllsource = 0, prediv1factor = 0;
   \   00000002   0x2000             MOVS     R0,#+0
   \   00000004   0x2000             MOVS     R0,#+0
   \   00000006   0x2000             MOVS     R0,#+0
   \   00000008   0x2000             MOVS     R0,#+0
    218          
    219            /* Get SYSCLK source -------------------------------------------------------*/
    220            tmp = RCC->CFGR & RCC_CFGR_SWS;
   \   0000000A   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   0000000C   0x6801             LDR      R1,[R0, #+0]
   \   0000000E   0x200C             MOVS     R0,#+12
   \   00000010   0x4008             ANDS     R0,R0,R1
    221            
    222            switch (tmp)
   \   00000012   0x2800             CMP      R0,#+0
   \   00000014   0xD004             BEQ      ??SystemCoreClockUpdate_0
   \   00000016   0x2804             CMP      R0,#+4
   \   00000018   0xD006             BEQ      ??SystemCoreClockUpdate_1
   \   0000001A   0x2808             CMP      R0,#+8
   \   0000001C   0xD008             BEQ      ??SystemCoreClockUpdate_2
   \   0000001E   0xE026             B        ??SystemCoreClockUpdate_3
    223            {
    224              case 0x00:  /* HSI used as system clock */
    225                SystemCoreClock = HSI_VALUE;
   \                     ??SystemCoreClockUpdate_0: (+1)
   \   00000020   0x....             LDR      R0,??DataTable2_11  ;; 0x7a1200
   \   00000022   0x....             LDR      R1,??DataTable2_12
   \   00000024   0x6008             STR      R0,[R1, #+0]
    226                break;
   \   00000026   0xE025             B        ??SystemCoreClockUpdate_4
    227              case 0x04:  /* HSE used as system clock */
    228                SystemCoreClock = HSE_VALUE;
   \                     ??SystemCoreClockUpdate_1: (+1)
   \   00000028   0x....             LDR      R0,??DataTable2_13  ;; 0x5b8d80
   \   0000002A   0x....             LDR      R1,??DataTable2_12
   \   0000002C   0x6008             STR      R0,[R1, #+0]
    229                break;
   \   0000002E   0xE021             B        ??SystemCoreClockUpdate_4
    230              case 0x08:  /* PLL used as system clock */
    231                /* Get PLL clock source and multiplication factor ----------------------*/
    232                pllmull = RCC->CFGR & RCC_CFGR_PLLMULL;
   \                     ??SystemCoreClockUpdate_2: (+1)
   \   00000030   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000032   0x6801             LDR      R1,[R0, #+0]
   \   00000034   0x20F0             MOVS     R0,#+240
   \   00000036   0x0380             LSLS     R0,R0,#+14       ;; #+3932160
   \   00000038   0x4008             ANDS     R0,R0,R1
    233                pllsource = RCC->CFGR & RCC_CFGR_PLLSRC;
   \   0000003A   0x....             LDR      R1,??DataTable2_1  ;; 0x40021004
   \   0000003C   0x6809             LDR      R1,[R1, #+0]
   \   0000003E   0x2280             MOVS     R2,#+128
   \   00000040   0x0252             LSLS     R2,R2,#+9        ;; #+65536
   \   00000042   0x4011             ANDS     R1,R1,R2
    234                pllmull = ( pllmull >> 18) + 2;
   \   00000044   0x0C84             LSRS     R4,R0,#+18
   \   00000046   0x1CA4             ADDS     R4,R4,#+2
    235                
    236                if (pllsource == 0x00)
   \   00000048   0x2900             CMP      R1,#+0
   \   0000004A   0xD104             BNE      ??SystemCoreClockUpdate_5
    237                {
    238                  /* HSI oscillator clock divided by 2 selected as PLL clock entry */
    239                  SystemCoreClock = (HSI_VALUE >> 1) * pllmull;
   \   0000004C   0x....             LDR      R0,??DataTable2_14  ;; 0x3d0900
   \   0000004E   0x4344             MULS     R4,R0,R4
   \   00000050   0x....             LDR      R0,??DataTable2_12
   \   00000052   0x6004             STR      R4,[R0, #+0]
   \   00000054   0xE00A             B        ??SystemCoreClockUpdate_6
    240                }
    241                else
    242                {
    243                  prediv1factor = (RCC->CFGR2 & RCC_CFGR2_PREDIV1) + 1;
   \                     ??SystemCoreClockUpdate_5: (+1)
   \   00000056   0x....             LDR      R0,??DataTable2_6  ;; 0x4002102c
   \   00000058   0x6800             LDR      R0,[R0, #+0]
   \   0000005A   0x0701             LSLS     R1,R0,#+28       ;; ZeroExtS R1,R0,#+28,#+28
   \   0000005C   0x0F09             LSRS     R1,R1,#+28
   \   0000005E   0x1C49             ADDS     R1,R1,#+1
    244                  /* HSE oscillator clock selected as PREDIV1 clock entry */
    245                  SystemCoreClock = (HSE_VALUE / prediv1factor) * pllmull; 
   \   00000060   0x....             LDR      R0,??DataTable2_13  ;; 0x5b8d80
   \   00000062   0x.... 0x....      BL       __aeabi_uidiv
   \   00000066   0x4360             MULS     R0,R4,R0
   \   00000068   0x....             LDR      R1,??DataTable2_12
   \   0000006A   0x6008             STR      R0,[R1, #+0]
    246                }      
    247                break;
   \                     ??SystemCoreClockUpdate_6: (+1)
   \   0000006C   0xE002             B        ??SystemCoreClockUpdate_4
    248              default: /* HSI used as system clock */
    249                SystemCoreClock = HSI_VALUE;
   \                     ??SystemCoreClockUpdate_3: (+1)
   \   0000006E   0x....             LDR      R0,??DataTable2_11  ;; 0x7a1200
   \   00000070   0x....             LDR      R1,??DataTable2_12
   \   00000072   0x6008             STR      R0,[R1, #+0]
    250                break;
    251            }
    252            /* Compute HCLK clock frequency ----------------*/
    253            /* Get HCLK prescaler */
    254            tmp = AHBPrescTable[((RCC->CFGR & RCC_CFGR_HPRE) >> 4)];
   \                     ??SystemCoreClockUpdate_4: (+1)
   \   00000074   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000076   0x6800             LDR      R0,[R0, #+0]
   \   00000078   0x....             LDR      R1,??DataTable2_15
   \   0000007A   0x0900             LSRS     R0,R0,#+4
   \   0000007C   0x0700             LSLS     R0,R0,#+28       ;; ZeroExtS R0,R0,#+28,#+28
   \   0000007E   0x0F00             LSRS     R0,R0,#+28
   \   00000080   0x5C08             LDRB     R0,[R1, R0]
    255            /* HCLK clock frequency */
    256            SystemCoreClock >>= tmp;  
   \   00000082   0x....             LDR      R1,??DataTable2_12
   \   00000084   0x6809             LDR      R1,[R1, #+0]
   \   00000086   0x40C1             LSRS     R1,R1,R0
   \   00000088   0x....             LDR      R0,??DataTable2_12
   \   0000008A   0x6001             STR      R1,[R0, #+0]
    257          }
   \   0000008C   0xBD10             POP      {R4,PC}          ;; return
    258          
    259          /**
    260            * @brief  Configures the System clock frequency, AHB/APBx prescalers and Flash
    261            *         settings.
    262            * @note   This function should be called only once the RCC clock configuration
    263            *         is reset to the default reset state (done in SystemInit() function).
    264            * @param  None
    265            * @retval None
    266            */

   \                                 In section .text, align 2, keep-with-next
    267          static void SetSysClock(void)
    268          {  
   \                     SetSysClock: (+1)
   \   00000000   0xB5C0             PUSH     {R6,R7,LR}
    269            /* SYSCLK, HCLK, PCLK configuration ----------------------------------------*/
    270          #if defined (PLL_SOURCE_HSI)
    271            /* At this stage the HSI is already enabled */
    272          
    273            /* Enable Prefetch Buffer and set Flash Latency */
    274            FLASH->ACR = FLASH_ACR_PRFTBE | FLASH_ACR_LATENCY;
    275           
    276            /* HCLK = SYSCLK (SYSCLK не делится)*/
    277            RCC->CFGR |= (uint32_t)RCC_CFGR_HPRE_DIV1;
    278                
    279            /* PCLK = HCLK */
    280            RCC->CFGR |= (uint32_t)RCC_CFGR_PPRE_DIV1;
    281          
    282            /* PLL configuration = (HSI/2) * 12 = ~48 MHz */
    283            RCC->CFGR &= (uint32_t)((uint32_t)~(RCC_CFGR_PLLSRC | RCC_CFGR_PLLXTPRE | RCC_CFGR_PLLMULL));
    284            RCC->CFGR |= (uint32_t)(RCC_CFGR_PLLSRC_HSI_Div2 | RCC_CFGR_PLLXTPRE_PREDIV1 | RCC_CFGR_PLLMULL12);
    285                      
    286            /* Enable PLL */
    287            RCC->CR |= RCC_CR_PLLON;
    288          
    289            /* Wait till PLL is ready */
    290            while((RCC->CR & RCC_CR_PLLRDY) == 0)
    291            {
    292            }
    293          
    294            /* Select PLL as system clock source */
    295            RCC->CFGR &= (uint32_t)((uint32_t)~(RCC_CFGR_SW));
    296            RCC->CFGR |= (uint32_t)RCC_CFGR_SW_PLL;    
    297          
    298            /* Wait till PLL is used as system clock source */
    299            while ((RCC->CFGR & (uint32_t)RCC_CFGR_SWS) != (uint32_t)RCC_CFGR_SWS_PLL)
    300            {
    301            }
    302          #else
    303            __IO uint32_t StartUpCounter = 0, HSEStatus = 0;
   \   00000002   0x2000             MOVS     R0,#+0
   \   00000004   0x9001             STR      R0,[SP, #+4]
   \   00000006   0x2000             MOVS     R0,#+0
   \   00000008   0x9000             STR      R0,[SP, #+0]
    304           #if defined (PLL_SOURCE_HSE)
    305            /* Enable HSE */    
    306            RCC->CR |= ((uint32_t)RCC_CR_HSEON);
   \   0000000A   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   0000000C   0x6800             LDR      R0,[R0, #+0]
   \   0000000E   0x2180             MOVS     R1,#+128
   \   00000010   0x0249             LSLS     R1,R1,#+9        ;; #+65536
   \   00000012   0x4301             ORRS     R1,R1,R0
   \   00000014   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   00000016   0x6001             STR      R1,[R0, #+0]
    307           #elif defined (PLL_SOURCE_HSE_BYPASS)
    308            /* HSE oscillator bypassed with external clock */    
    309            RCC->CR |= (uint32_t)(RCC_CR_HSEON | RCC_CR_HSEBYP);
    310           #endif /* PLL_SOURCE_HSE */
    311             
    312            /* Wait till HSE is ready and if Time out is reached exit */
    313            do
    314            {
    315              HSEStatus = RCC->CR & RCC_CR_HSERDY;
   \                     ??SetSysClock_0: (+1)
   \   00000018   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   0000001A   0x6800             LDR      R0,[R0, #+0]
   \   0000001C   0x2180             MOVS     R1,#+128
   \   0000001E   0x0289             LSLS     R1,R1,#+10       ;; #+131072
   \   00000020   0x4008             ANDS     R0,R0,R1
   \   00000022   0x9000             STR      R0,[SP, #+0]
    316              StartUpCounter++;  
   \   00000024   0x9801             LDR      R0,[SP, #+4]
   \   00000026   0x1C40             ADDS     R0,R0,#+1
   \   00000028   0x9001             STR      R0,[SP, #+4]
    317            } while((!HSEStatus) && (StartUpCounter <= HSE_STARTUP_TIMEOUT));
   \   0000002A   0x9800             LDR      R0,[SP, #+0]
   \   0000002C   0x2800             CMP      R0,#+0
   \   0000002E   0xD103             BNE      ??SetSysClock_1
   \   00000030   0x9801             LDR      R0,[SP, #+4]
   \   00000032   0x....             LDR      R1,??DataTable2_16  ;; 0x501
   \   00000034   0x4288             CMP      R0,R1
   \   00000036   0xD3EF             BCC      ??SetSysClock_0
    318          
    319            // после цикла ожидания HSEStatus == 0 при не готовности RCC_CR_HSERDY
    320            if (HSEStatus)
   \                     ??SetSysClock_1: (+1)
   \   00000038   0x9800             LDR      R0,[SP, #+0]
   \   0000003A   0x2800             CMP      R0,#+0
   \   0000003C   0xD035             BEQ      ??SetSysClock_2
    321            {
    322              /* Enable Prefetch Buffer and set Flash Latency */
    323              FLASH->ACR = FLASH_ACR_PRFTBE | FLASH_ACR_LATENCY;
   \   0000003E   0x2011             MOVS     R0,#+17
   \   00000040   0x....             LDR      R1,??DataTable2_17  ;; 0x40022000
   \   00000042   0x6008             STR      R0,[R1, #+0]
    324           
    325              /* HCLK = SYSCLK */
    326              RCC->CFGR |= (uint32_t)RCC_CFGR_HPRE_DIV1;
   \   00000044   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000046   0x6800             LDR      R0,[R0, #+0]
   \   00000048   0x....             LDR      R1,??DataTable2_1  ;; 0x40021004
   \   0000004A   0x6008             STR      R0,[R1, #+0]
    327                
    328              /* PCLK = HCLK */
    329              RCC->CFGR |= (uint32_t)RCC_CFGR_PPRE_DIV1;
   \   0000004C   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   0000004E   0x6800             LDR      R0,[R0, #+0]
   \   00000050   0x....             LDR      R1,??DataTable2_1  ;; 0x40021004
   \   00000052   0x6008             STR      R0,[R1, #+0]
    330          
    331              /* PLL configuration = HSE * 8 = 48 MHz */
    332              RCC->CFGR &= (uint32_t)((uint32_t)~(RCC_CFGR_PLLSRC | RCC_CFGR_PLLXTPRE | RCC_CFGR_PLLMULL));
   \   00000054   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000056   0x6800             LDR      R0,[R0, #+0]
   \   00000058   0x....             LDR      R1,??DataTable2_5  ;; 0xffc0ffff
   \   0000005A   0x4001             ANDS     R1,R1,R0
   \   0000005C   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   0000005E   0x6001             STR      R1,[R0, #+0]
    333              RCC->CFGR |= (uint32_t)(RCC_CFGR_PLLSRC_PREDIV1 | RCC_CFGR_PLLXTPRE_PREDIV1 | RCC_CFGR_PLLMULL8);
   \   00000060   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000062   0x6800             LDR      R0,[R0, #+0]
   \   00000064   0x21C8             MOVS     R1,#+200
   \   00000066   0x0349             LSLS     R1,R1,#+13       ;; #+1638400
   \   00000068   0x4301             ORRS     R1,R1,R0
   \   0000006A   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   0000006C   0x6001             STR      R1,[R0, #+0]
    334                      
    335              /* Enable PLL */
    336              RCC->CR |= RCC_CR_PLLON;
   \   0000006E   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   00000070   0x6800             LDR      R0,[R0, #+0]
   \   00000072   0x2180             MOVS     R1,#+128
   \   00000074   0x0449             LSLS     R1,R1,#+17       ;; #+16777216
   \   00000076   0x4301             ORRS     R1,R1,R0
   \   00000078   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   0000007A   0x6001             STR      R1,[R0, #+0]
    337          
    338              /* Wait till PLL is ready */
    339              while((RCC->CR & RCC_CR_PLLRDY) == 0)
   \                     ??SetSysClock_3: (+1)
   \   0000007C   0x....             LDR      R0,??DataTable2  ;; 0x40021000
   \   0000007E   0x6800             LDR      R0,[R0, #+0]
   \   00000080   0x0180             LSLS     R0,R0,#+6
   \   00000082   0xD5FB             BPL      ??SetSysClock_3
    340              {
    341              }
    342          
    343              /* Select PLL as system clock source */
    344              RCC->CFGR &= (uint32_t)((uint32_t)~(RCC_CFGR_SW));
   \   00000084   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000086   0x6800             LDR      R0,[R0, #+0]
   \   00000088   0x2103             MOVS     R1,#+3
   \   0000008A   0x4388             BICS     R0,R0,R1
   \   0000008C   0x....             LDR      R1,??DataTable2_1  ;; 0x40021004
   \   0000008E   0x6008             STR      R0,[R1, #+0]
    345              RCC->CFGR |= (uint32_t)RCC_CFGR_SW_PLL;    
   \   00000090   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   00000092   0x6800             LDR      R0,[R0, #+0]
   \   00000094   0x2102             MOVS     R1,#+2
   \   00000096   0x4301             ORRS     R1,R1,R0
   \   00000098   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   0000009A   0x6001             STR      R1,[R0, #+0]
    346          
    347              /* Wait till PLL is used as system clock source */
    348              while ((RCC->CFGR & (uint32_t)RCC_CFGR_SWS) != (uint32_t)RCC_CFGR_SWS_PLL)
   \                     ??SetSysClock_4: (+1)
   \   0000009C   0x....             LDR      R0,??DataTable2_1  ;; 0x40021004
   \   0000009E   0x6800             LDR      R0,[R0, #+0]
   \   000000A0   0x210C             MOVS     R1,#+12
   \   000000A2   0x4001             ANDS     R1,R1,R0
   \   000000A4   0x2908             CMP      R1,#+8
   \   000000A6   0xD1F9             BNE      ??SetSysClock_4
    349              {
    350              }
    351            }
    352            else
    353            { /* If HSE fails to start-up, the application will have wrong clock 
    354                   configuration. User can add here some code to deal with this error */
    355          	while (1);	// здесь и остановимся
    356            }  
    357          #endif /* PLL_SOURCE_HSI */  
    358          }
   \   000000A8   0xBD03             POP      {R0,R1,PC}       ;; return
   \                     ??SetSysClock_2: (+1)
   \   000000AA   0xE7FE             B        ??SetSysClock_2

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2:
   \   00000000   0x40021000         DC32     0x40021000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_1:
   \   00000000   0x40021004         DC32     0x40021004

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_2:
   \   00000000   0xF8FFB80C         DC32     0xf8ffb80c

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_3:
   \   00000000   0xFEF6FFFF         DC32     0xfef6ffff

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_4:
   \   00000000   0xFFFBFFFF         DC32     0xfffbffff

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_5:
   \   00000000   0xFFC0FFFF         DC32     0xffc0ffff

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_6:
   \   00000000   0x4002102C         DC32     0x4002102c

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_7:
   \   00000000   0x40021030         DC32     0x40021030

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_8:
   \   00000000   0xFFFFFEAC         DC32     0xfffffeac

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_9:
   \   00000000   0x40021034         DC32     0x40021034

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_10:
   \   00000000   0x40021008         DC32     0x40021008

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_11:
   \   00000000   0x007A1200         DC32     0x7a1200

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_12:
   \   00000000   0x........         DC32     SystemCoreClock

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_13:
   \   00000000   0x005B8D80         DC32     0x5b8d80

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_14:
   \   00000000   0x003D0900         DC32     0x3d0900

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_15:
   \   00000000   0x........         DC32     AHBPrescTable

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_16:
   \   00000000   0x00000501         DC32     0x501

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_17:
   \   00000000   0x40022000         DC32     0x40022000
    359          
    360          /**
    361            * @}
    362            */
    363          
    364          /**
    365            * @}
    366            */
    367          
    368          /**
    369            * @}
    370            */
    371          
    372          /************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      12   SetSysClock
       8   SystemCoreClockUpdate
         8 __aeabi_uidiv
       8   SystemInit
         8   -> SetSysClock


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable2
       4  ??DataTable2_1
       4  ??DataTable2_10
       4  ??DataTable2_11
       4  ??DataTable2_12
       4  ??DataTable2_13
       4  ??DataTable2_14
       4  ??DataTable2_15
       4  ??DataTable2_16
       4  ??DataTable2_17
       4  ??DataTable2_2
       4  ??DataTable2_3
       4  ??DataTable2_4
       4  ??DataTable2_5
       4  ??DataTable2_6
       4  ??DataTable2_7
       4  ??DataTable2_8
       4  ??DataTable2_9
      16  AHBPrescTable
     172  SetSysClock
       4  SystemCoreClock
     142  SystemCoreClockUpdate
     110  SystemInit

 
  20 bytes in section .data
 496 bytes in section .text
 
 496 bytes of CODE memory
  20 bytes of DATA memory

Errors: none
Warnings: none
